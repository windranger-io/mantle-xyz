import { useContext } from "react";
import StateContext from "@providers/stateContext";

import { Direction, L1_CHAIN_ID, L2_CHAIN_ID } from "@config/constants";
import { useSwitchToNetwork } from "@hooks/useSwitchToNetwork";

import { Button, Typography } from "@mantle/ui";
import { MdClear } from "react-icons/md";

export default function CTAPageError({
  reset,
  closeModal,
}: {
  reset: () => void;
  closeModal: () => void;
}) {
  const { ctaChainId: chainId, ctaErrorReset } = useContext(StateContext);

  const direction =
    chainId === L1_CHAIN_ID ? Direction.Deposit : Direction.Withdraw;

  const { addNetwork } = useSwitchToNetwork();

  return (
    <>
      <span className="flex justify-between align-middle">
        <Typography variant="modalHeading" className="text-center w-full">
          Transaction failed
        </Typography>
        <Typography variant="modalHeading" className="text-white w-auto pt-1">
          <MdClear onClick={closeModal} className="cursor-pointer" />
        </Typography>
      </span>
      <div className="flex items-center justify-center">
        <svg
          width="54"
          height="66"
          viewBox="0 0 54 66"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M26.9154 36.375L32.7835 42.2849C33.3159 42.845 33.9431 43.125 34.6654 43.125C35.3876 43.125 36.0265 42.8473 36.582 42.2917C37.1098 41.7639 37.3737 41.1528 37.3737 40.4584C37.3737 39.7639 37.1075 39.1379 36.5752 38.5803L30.7904 32.8144L36.5752 27.0485C37.052 26.5718 37.2904 25.9723 37.2904 25.25C37.2904 24.5278 37.0543 23.9167 36.582 23.4167C36.082 22.9445 35.4848 22.7084 34.7904 22.7084C34.0959 22.7084 33.5103 22.9468 33.0335 23.4235L27.1844 29.2917L21.2518 23.4235C20.6942 22.8912 20.0543 22.625 19.332 22.625C18.6098 22.625 17.9848 22.8889 17.457 23.4167C16.9015 23.9723 16.6237 24.5973 16.6237 25.2917C16.6237 25.9862 16.9038 26.5995 17.4639 27.1319L23.2904 32.9167L17.457 38.75C16.957 39.25 16.707 39.8473 16.707 40.5417C16.707 41.2362 16.957 41.8195 17.457 42.2917C17.9293 42.7917 18.5126 43.0417 19.207 43.0417C19.9015 43.0417 20.4987 42.7917 20.9987 42.2917L26.9154 36.375ZM26.9987 65.6667C26.8043 65.6667 26.6098 65.6459 26.4154 65.6042C26.2209 65.5625 26.0391 65.5265 25.87 65.4961C18.5114 63.3043 12.4779 58.7832 7.76953 51.9328C3.0612 45.0823 0.707031 37.5715 0.707031 29.4003V13.1891C0.707031 12.2031 0.999365 11.2924 1.58403 10.4572C2.1687 9.62204 2.91803 9.02521 3.83203 8.66671L25.332 0.625041C25.9015 0.430596 26.457 0.333374 26.9987 0.333374C27.5404 0.333374 28.1098 0.430596 28.707 0.625041L50.207 8.66671C51.0933 9.02521 51.8287 9.62204 52.4134 10.4572C52.998 11.2924 53.2904 12.2031 53.2904 13.1891V29.4003C53.2904 37.5715 50.9362 45.0823 46.2279 51.9328C41.5195 58.7832 35.4848 63.3056 28.1237 65.5C28.207 65.4723 27.832 65.5278 26.9987 65.6667ZM26.9987 60.875C33.332 58.7639 38.4987 54.7958 42.4987 48.9706C46.4987 43.1454 48.4987 36.6274 48.4987 29.4167V13.199L26.9987 5.12504L5.4987 13.199V29.4167C5.4987 36.6274 7.4987 43.1454 11.4987 48.9706C15.4987 54.7958 20.6654 58.7639 26.9987 60.875Z"
            fill="#E22F3D"
          />
        </svg>
      </div>
      <div className="py-4 text-center text-lg">
        Something went wrong. Try again.
      </div>
      <div>
        {(direction === Direction.Deposit && (
          <Button
            type="button"
            size="full"
            className="h-14 flex flex-row gap-4 text-center items-center justify-center my-4"
            onClick={() => addNetwork(L2_CHAIN_ID)}
          >
            <svg
              width="27"
              height="26"
              viewBox="0 0 27 26"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M23.2531 2.97583L14.7988 9.18981L16.3622 5.52364L23.2531 2.97583Z"
                fill="#E2761B"
              />
              <path
                d="M3.73591 2.97583L12.1222 9.24867L10.6353 5.52364L3.73591 2.97583ZM20.2111 17.3798L17.9594 20.7937L22.7771 22.1055L24.1621 17.4555L20.2111 17.3798ZM2.84375 17.4555L4.22022 22.1055L9.03787 20.7937L6.78623 17.3798L2.84375 17.4555Z"
                fill="#E4761B"
              />
              <path
                d="M8.76631 11.6115L7.42383 13.6212L12.2075 13.8314L12.0376 8.74416L8.76631 11.6115ZM18.2232 11.6115L14.9094 8.6853L14.799 13.8314L19.5742 13.6212L18.2232 11.6115ZM9.03821 20.7937L11.9101 19.4063L9.42906 17.4891L9.03821 20.7937ZM15.0794 19.4063L17.9598 20.7937L17.5604 17.4891L15.0794 19.4063Z"
                fill="#E4761B"
              />
              <path
                d="M17.9606 20.7937L15.0802 19.4062L15.3097 21.2646L15.2842 22.0466L17.9606 20.7937ZM9.03906 20.7937L11.7155 22.0466L11.6985 21.2646L11.911 19.4062L9.03906 20.7937Z"
                fill="#D7C1B3"
              />
              <path
                d="M11.7574 16.2614L9.36133 15.5635L11.0522 14.7983L11.7574 16.2614ZM15.2326 16.2614L15.9378 14.7983L17.6371 15.5635L15.2326 16.2614Z"
                fill="#233447"
              />
              <path
                d="M9.03874 20.7937L9.44659 17.3798L6.78711 17.4554L9.03874 20.7937ZM17.5525 17.3798L17.9603 20.7937L20.2119 17.4554L17.5525 17.3798ZM19.5747 13.6211L14.7995 13.8313L15.2414 16.2614L15.9466 14.7983L17.6459 15.5635L19.5747 13.6211ZM9.36162 15.5635L11.061 14.7983L11.7577 16.2614L12.208 13.8313L7.42436 13.6211L9.36162 15.5635Z"
                fill="#CD6116"
              />
              <path
                d="M7.42383 13.6211L9.42906 17.4891L9.36108 15.5635L7.42383 13.6211ZM17.6454 15.5635L17.5604 17.4891L19.5742 13.6211L17.6454 15.5635ZM12.2075 13.8313L11.7572 16.2614L12.3179 19.1287L12.4454 15.3533L12.2075 13.8313ZM14.799 13.8313L14.5696 15.3449L14.6715 19.1287L15.2408 16.2614L14.799 13.8313Z"
                fill="#E4751F"
              />
              <path
                d="M15.2411 16.2615L14.6718 19.1289L15.0796 19.4063L17.5607 17.4892L17.6456 15.5636L15.2411 16.2615ZM9.36133 15.5636L9.4293 17.4892L11.9103 19.4063L12.3182 19.1289L11.7574 16.2615L9.36133 15.5636Z"
                fill="#F6851B"
              />
              <path
                d="M15.2842 22.0466L15.3097 21.2646L15.0972 21.0796H11.894L11.6985 21.2646L11.7155 22.0466L9.03906 20.7937L9.9737 21.5505L11.8685 22.8538H15.1227L17.026 21.5505L17.9606 20.7937L15.2842 22.0466Z"
                fill="#C0AD9E"
              />
              <path
                d="M15.079 19.4063L14.6711 19.1288H12.3175L11.9097 19.4063L11.6973 21.2646L11.8927 21.0796H15.096L15.3084 21.2646L15.079 19.4063Z"
                fill="#161616"
              />
              <path
                d="M23.6105 9.59342L24.3327 6.1627L23.2536 2.97583L15.0797 8.97959L18.2235 11.6115L22.6673 12.898L23.6529 11.7628L23.2281 11.4601L23.9078 10.8463L23.381 10.4427L24.0608 9.92977L23.6105 9.59342ZM2.66602 6.1627L3.38824 9.59342L2.92941 9.92977L3.60915 10.4427L3.09085 10.8463L3.77059 11.4601L3.34575 11.7628L4.32288 12.898L8.76667 11.6115L11.9105 8.97959L3.7366 2.97583L2.66602 6.1627Z"
                fill="#763D16"
              />
              <path
                d="M22.6666 12.898L18.2228 11.6115L19.5738 13.6212L17.5601 17.4892L20.2111 17.4555H24.1621L22.6666 12.898ZM8.76597 11.6115L4.32218 12.898L2.84375 17.4555H6.78623L9.42872 17.4892L7.42349 13.6212L8.76597 11.6115ZM14.7987 13.8314L15.079 8.97963L16.3705 5.52368H10.6353L11.9098 8.97963L12.2071 13.8314L12.3091 15.3618L12.3176 19.1288H14.6712L14.6882 15.3618L14.7987 13.8314Z"
                fill="#F6851B"
              />
            </svg>
            Add Mantle Network to Wallet
          </Button>
        )) || <div />}
        <Button
          type="button"
          size="full"
          className="h-14 my-4"
          onClick={() =>
            // either recall the tx and try waiting again or clear everything and go back to the initial screen
            ctaErrorReset.current ? ctaErrorReset.current() : reset()
          }
        >
          Try again...
        </Button>
      </div>
    </>
  );
}
